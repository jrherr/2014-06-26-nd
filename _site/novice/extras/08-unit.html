<!DOCTYPE html>
<html>
  <head>
    
      <title>Unit Testing</title>
    
    <link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico" />
<link href="../../css/bootstrap/bootstrap.css" rel="stylesheet" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="../../css/bootstrap/bootstrap-responsive.css" rel="stylesheet" />
<link rel="stylesheet" type="text/css" href="../../css/swc.css" />
<link rel="stylesheet" type="text/css" href="../../css/swc-bootstrap.css" />
<link rel="alternate" type="application/rss+xml" title="The Software Carpentry Blog" href="/feed.xml"/>
<meta charset="UTF-8" />
<meta http-equiv="last-modified" content="" />
<!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

    <link rel="stylesheet" type="text/css" href="../../css/lesson.css" />
  </head>
  <body>
    <div class="container">
      <div class="banner">
  <a href="http://software-carpentry.org" title="Software Carpentry">
    <img alt="Software Carpentry banner" src="../../img/software-carpentry-banner.png" />
  </a>
</div>


      <div class="row-fluid">
        <div class="span10 offset1">
	  <!-- start content -->
          
          <h1>Unit Testing</h1>
          
          <p>Most people don&#39;t enjoy writing tests,
so if we want them to actually do it,
it must be easy to:</p>

<ul>
<li>add or change tests,</li>
<li>understand the tests that have already been written,</li>
<li>run those tests, and</li>
<li>understand those tests' results.</li>
</ul>

<p>Test results must also be reliable.
If a testing tool says that code is working when it&#39;s not,
or reports problems when there actually aren&#39;t any,
people will lose faith in it and stop using it.</p>

<p>The simplest kind of test is a <a href="../gloss.html#unit-test">unit test</a>
that checks the behavior of one component of a program.
As an example,
suppose we&#39;re testing a function called <code>rectangle_area</code>
that returns the area of an <code>(x0, y0, x1, y1)</code> rectangle.
We&#39;ll start by testing our code directly using <code>assert</code>.
Here,
we call the function three times with different arguments,
checking that the right value is returned each time.</p>

<pre><code>from rectangle import rectangle_area

assert rectangle_area([0, 0, 1, 1]) == 1.0
assert rectangle_area([1, 1, 4, 4]) == 9.0
assert rectangle_area([0, 1, 4, 7]) == 24.0

&lt;span class="err"&gt;---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)

&lt;ipython-input-16-ebf7f5f1c120&gt; in &lt;module&gt;()
3 assert rectangle_area([0, 0, 1, 1]) == 1.0
4 assert rectangle_area([1, 1, 4, 4]) == 9.0
----&gt; 5 assert rectangle_area([0, 1, 4, 7]) == 24.0

AssertionError:
</code></pre>

<p>This result is used,
in the sense that we know something&#39;s wrong,
but look closely at what happens if we run the tests in a different order:</p>

<pre><code>assert rectangle_area([0, 1, 4, 7]) == 24.0
assert rectangle_area([1, 1, 4, 4]) == 9.0
assert rectangle_area([0, 0, 1, 1]) == 1.0

&lt;span class="err"&gt;---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)

&lt;ipython-input-17-548f3f32c981&gt; in &lt;module&gt;()
----&gt; 1 assert rectangle_area([0, 1, 4, 7]) == 24.0
2 assert rectangle_area([1, 1, 4, 4]) == 9.0
3 assert rectangle_area([0, 0, 1, 1]) == 1.0

AssertionError:
</code></pre>

<p>Python halts at the first failed assertion,
so the second and third tests aren&#39;t run at all.
It would be more helpful if we could get data from all of our tests every time
they&#39;re run,
since the more information we have,
the faster we&#39;re likely to be able to track down bugs.
It would also be helpful to have some kind of summary report:
if our <a href="../gloss.html#test-suite">test suite</a> includes thirty or forty tests
(as it well might for a complex function or library that&#39;s widely used),
we&#39;d like to know how many passed or failed.</p>

<p>Here&#39;s a different approach.
First, let&#39;s put each test in a function with a meaningful name:</p>

<pre><code>def test_unit_square():
    assert rectangle_area([0, 0, 1, 1]) == 1.0

def test_large_square():
    assert rectangle_area([1, 1, 4, 4]) == 9.0

def test_actual_rectangle():
    assert rectangle_area([0, 1, 4, 7]) == 24.0
</code></pre>

<p>Next,
import a library called <code>ears</code>
and ask it to run our tests for us:</p>

<pre><code>import ears
ears.run()

..f
2 pass, 1 fail, 0 error
----------------------------------------
fail: test_actual_rectangle
Traceback (most recent call last):
  File "ears.py", line 45, in run
test()
  File "&lt;ipython-input-18-643689ad0a0f&gt;", line 8, in test_actual_rectangle
assert rectangle_area([0, 1, 4, 7]) == 24.0
AssertionError
</code></pre>

<p><code>ears.run</code> looks in the calling program
for functions whose names start with the letters <code>'test_'</code>
and runs each one.
If the function complete without an assertion being triggered,
we count the test as a <a href="../gloss.html#test-success">success</a>.
If an assertion fails,
we count the test as a <a href="../gloss.html#test-failure">failure</a>,
but if any other exception occurs,
we count it as an <a href="../gloss.html#test_error">error</a>
because the odds are that the test itself is broken.</p>

<p><code>ears</code> is an <a href="../gloss.html#xunit">xUnit testing library</a>.
The name &quot;xUnit&quot; comes from the fact that
many of them are imitations of a Java testing library called JUnit.
The <a href="http://en.wikipedia.org/wiki/List_of_unit_testing_frameworks">Wikipedia page</a> on the subject subject
lists dozens of similar frameworks in almost as many languages,
all of which have a similar structure:
each test is a single function that follows some naming convention
(e.g., starts with <code>'test_'</code>),
and the framework runs them in some order
and reports how many passed, failed, or were broken.</p>

	  <!-- end content -->
	</div>
      </div>

      <div class="footer">
  <a class="label swc-blue-bg" href="https://www.facebook.com/SoftwareCarpentry">Facebook</a>
  <a class="label swc-blue-bg" href="https://plus.google.com/+Software-carpentryOrg">Google+</a>
  <a class="label swc-blue-bg" href="https://twitter.com/swcarpentry">Twitter</a>
  <a class="label swc-blue-bg" href="https://github.com/swcarpentry">GitHub</a>
  <a class="label swc-blue-bg" href="http://software-carpentry.org/feed.xml">RSS</a>
  <a class="label swc-blue-bg" href="../../LICENSE.html">License</a>
  <a class="bugreport label swc-blue-bg" href="mailto:info@software-carpentry.org?subject=bug%20in%20novice/extras/08-unit.md">Bug Report</a>
</div>

    </div>
    <!-- Le javascript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="../../js/jquery-1.9.1.min.js"></script>
<script src="../../js/bootstrap/bootstrap.min.js"></script>

  </body>
</html>
